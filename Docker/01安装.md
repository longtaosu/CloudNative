# 安装Docker

安装软件包

```shell
yum install -y yum-utils  device-mapper-persistent-data lvm2
```

添加yum源

```shell
yum-config-manager \
--add-repo \
    https://download.docker.com/linux/centos/docker-ce.repo
```

查看可安装的版本

```shell
yum list docker-ce --showduplicates | sort -r
```

安装指定版本

```shell
yum install docker-ce-18.03.0.ce
```

安装最新版本

```shell
yum install docker-ce -y
```

启动docker并设置开机启动

```shell
systemctl start docker
systemctl enable docker
```

查看docker版本

```shell
docker version
```

![](01images_安装\01安装docker.png)

## 常见问题

- **容器时间问题**

```shell
docker exec -it <容器名> /bin/bash
ln -sf /usr/share/zoneinfo/Asia/Shanghai    /etc/localtime
docker restart <容器名>
```



# 安装Redis

```shell
docker run --name myredis -p 6379:6379 -d --restart=always redis:latest redis-server --appendonly yes --requirepass "your password"
```



# 安装Rabbitmq

```shell
docker run -d -p 5672:5672 -p 15672:15672 --name rabbitmq rabbitmq:management
```

安装后打开 ip:15672 进行查看，帐：guest，密：guest



# 安装ES

```shell
docker run -it --name myESServer -d -p 9200:9200 -p 9300:9300 -p 5601:5601 elasticsearch
```



# 安装MySql

> 安装时使用最后一种，且需要修改对应密码

```shell
docker run --name=mysqldb -p=3306:3306 --env="MYSQL_ROOT_PASSWORD=longtao" mysql:5.6
```

将MySql配置文件映射到本机

```shell
docker run --name mysqldb -p 3306:3306  -v $PWD/conf/my.cnf:/etc/my.cnf.d/ -v $PWD/logs:/logs -v $PWD/data:/data -e MYSQL_ROOT_PASSWORD=longtao -d mysql:8.0
```

对于8.0以上版本，报错：[Authentication plugin 'caching_sha2_password' cannot be loaded](https://github.com/passbolt/passbolt_docker/issues/103#) 

```shell
docker run --name mysqldb -p 3306:3306  -v $PWD/conf/my.cnf:/etc/my.cnf.d/ -v $PWD/logs:/logs -v $PWD/data:/data -e MYSQL_ROOT_PASSWORD=longtao -d mysql:8.0 --default-authentication-plugin=mysql_native_password
```

MySQL默认编码方式不是utf8mb4，可以在安装时修改指令

```shell
docker run --name mysqldb -p 3306:3306  -v $PWD/conf/my.cnf:/etc/my.cnf.d/ -v $PWD/logs:/logs -v $PWD/data:/data -e MYSQL_ROOT_PASSWORD=longtao -d mysql:8.0 --character-set-server=utf8mb4 --collation-server=utf8mb4_unicode_ci --default-authentication-plugin=mysql_native_password
```

## 常见问题

- **navicat无法连接**

![](01images_安装\02navicat无法连接.png)

**解决办法**：

进入mysql容器

```shell
docker  exec  -it  <63c9e29aelef(容器id)>  bash
```

进入容器

```shell
mysql  --user=root  --password 
```

根据提示输入密码，然后输入下面的命令，注意修改密码（newpassword）

```shell
ALTER  USER  'root'  IDENTIFIED  WITH  mysql_native_password  BY  'newpassword'; 
```







# 参考

https://www.cnblogs.com/imstrive/p/10615837.html